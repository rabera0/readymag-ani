import{b as jn,c as Rr,d as Qn,e as Or}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-IGLRBWZG.js";import{b as gr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-AT4N3DDO.js";import{a as Me,b as to}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-MAKHQFB6.js";import{b as Wn,c as vt,d as $n,e as zn,f as Vn,h as Yn,i as Gn}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-PEI2CY4Q.js";import{a as Jn,b as qn,c as Xn,d as Zn,f as tt,g as we,i as nt}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-6HWGW2EM.js";import{a as no,b as _r}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-3WFRPQ3A.js";import{r as ro,u as Ar}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-YLBHOHRG.js";import{b as so,d as Ur}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-3TNMIIPH.js";import{$ as sn,$b as Dn,Da as Qe,Ea as Cn,Eb as Et,Ga as bn,H as Ge,Hb as kt,J as tn,Jb as ye,Ka as En,M as nn,Mb as K,N as on,Pa as wr,Q as yt,Qa as kn,R as Oe,S as Je,Sa as Pr,Vb as Ln,W as rn,Wb as _n,X as be,Xa as Ee,Xb as Mn,Y as ht,Ya as vn,Yb as An,aa as ln,ab as wn,ac as Un,bb as et,bc as Bn,c as yr,ca as an,cc as Hn,d as hr,db as Pn,e as Sr,ea as qe,ga as St,h as Ye,ha as xt,ia as cn,ib as _e,ja as un,jb as In,k as xr,ka as dn,kb as ke,l as V,m as Zt,ma as Tt,na as fn,nc as ce,o as Re,oa as pn,pa as Cr,pc as Nn,qa as Xe,qc as fe,ra as mn,rb as Rn,sa as Ct,ua as gn,ub as On,vb as bt,wa as Er,wb as Fn,xa as Fe,y as en,z as Ce,za as yn}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-IWCOVASN.js";import{i as br}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-YM5H3BT6.js";import{f as Qt,w as Tr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-MVDJARLS.js";import{a as Le,g as Tn}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-PTOZSKV6.js";import{a as Yt,b as mr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-A23WIZTM.js";import{a as wt,b as Dr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-IHF35CFO.js";import{a as oo,b as Mr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-F2ITZIAF.js";import{a as eo,b as Fr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-64USIQ5L.js";import{a as O,d as ve}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-3GOT4LKE.js";import{a as Lr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-LGOXHTRZ.js";import{o as Kn,p as Ir}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-WSWR4Q44.js";import{r as Te,v as Ve}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-6KVCTNLD.js";import{a as Xt,h as Ze,i as xn}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-VMLLFM4X.js";import{c as hn,d as kr,h as Sn,j as vr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-BDTBHKNZ.js";import{c as Jt,e as qt}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-LA3FLWVR.js";import{B as ge,C as h,D as z,E as ne,d as $e,e as Gt,u as ze}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-U6WQ4G6W.js";import{a as ae}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-7ZY2VSVL.js";import{A as Vt,y as $t,z as zt}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-5JZ2YWXB.js";import{a as pr}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-CD44EXNS.js";import{a as _,d as H}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-4X7D5KOI.js";var Pt,io=_(()=>{"use strict";Ce();Je();ht();fe();Ur();Pt=({editorState:e,method:n})=>{let o=K(e,"LETTER_SPACING"),t=o&&o.length?parseFloat(o[0]):0,r=ce({editorState:e}),i=tn()||{project:[],global:[]},l=[...i.project,...i.global].find(u=>u.name===r),m=!!r&&be(l?.cssProperties.letterSpacing,!0),p=t||m||0,a=n==="decrease"?-1:1;return ye({key:"LETTER_SPACING",value:so(p+.2*a,2),editorState:e})}});var It,lo=_(()=>{"use strict";Ce();Re();fe();It=({editorState:e,method:n})=>{let o=K(e,"FONT_SIZE"),t=o&&o.length?parseInt(o[0]):V.fontSize,r=n==="decrease"?-1:1;return ye({key:"FONT_SIZE",value:t+r,editorState:e})}});function Ae(e){return!e.isFolder}function ao(e){return!!e.isFolder}function Rs({all:e,allProjects:n,excluded:o,selectedUser:t,me:r}){let s=(o||[]).map(i=>i._id);return t&&typeof t=="object"&&t._id&&s.push(t._id),e.reduce((i,l)=>{if(l.email===r.email)return i;let m=Hr(l,n)+Nr(l.folderIds||[],n).length,p={...l,projectsCount:m},a=i.map(d=>d._id);return!l.isPending&&![...s,...a].includes(l._id)?[...i,p]:i},[])}function Br(e){return e.reduce((n,o)=>Ae(o)?[...n,o.num_id]:n,[])}function Os(e){return e.reduce((n,o)=>ao(o)?[...n,o._id]:n,[])}function Hr(e,n){let o=Br(n);return e.projects?e.projects.filter(t=>!t.isArchived).length:e.sharesAll?n.length:e.projectNumIds.filter(t=>o.includes(t)).length}function Fs({projects:e,allTeammates:n,me:o}){return e.length?n.filter(t=>t.email===o.email?!1:!t.projects&&(t.sharesAll&&e.every(r=>Ae(r))||e.every(r=>Ae(r)&&(t.projectNumIds||[]).includes(r.num_id)||Ae(r)&&!!r.folder&&(t.folderIds||[]).includes(r.folder)||ao(r)&&(t.folderIds||[]).includes(r._id)))):[]}function Ls(e,n){let o=zt([...e,...n],"email");return o.map(t=>{if(!t.isPending)return t;let r=o.find(s=>s.email===t.email&&s._id!==t._id);return r?{...t,name:r.name,pic:r.pic}:t})}function Nr(e,n){return e?n.filter(o=>Ae(o)&&o.folder&&e.includes(o.folder)).map(o=>o.num_id):[]}function _s(e){return e&&e.plan_limits&&e.plan_limits.contributors||0}function Ms(e){return e.filter(n=>n.sharesAll||n.projectNumIds&&n.projectNumIds.length||n.folderIds&&n.folderIds.length)}function co({projectNumId:e,projectFolderId:n,folderId:o,teammate:t}){return typeof e=="number"&&t.projectRoles?.hasOwnProperty(e)?t.projectRoles[e]:typeof o=="string"&&t.folderRoles?.hasOwnProperty(o)?t.folderRoles[o]:typeof n=="string"&&t.folderRoles?.hasOwnProperty(n)?t.folderRoles[n]:null}function As({items:e=[],roles:n={},newItems:o,newRole:t}){let r={},s=[];for(let i of e)n.hasOwnProperty(i)&&(r[i]=n[i],s.push(i));if(t&&o?.length)for(let i of o)r[i]=t,s.includes(i)||s.push(i);return{roles:r,items:s}}var uo=_(()=>{"use strict";Vt()});var fo,pe,Rt=_(()=>{"use strict";uo();fo="projectRoles",pe={rolesList:[{name:"member",description:"Layout unlocked"},{name:"editor",description:"Layout locked",secondaryDescription:"Enables non-designers to make changes safely"}],isPermissionAllowed(e){return window.RM?.constructorRouter?.mag?.isPermissionAllowed?.(e)??!0},checkSelfRoleChanged({teammate:e,isOwner:n,projectNumId:o,userEmail:t,team:r}){if(n&&e.email===t){let s=e.projectRoles?.[o],i=r?.find(l=>l.email===t)?.projectRoles?.[o];return s!==i}return!1},getRoleForProject({team:e,projectNumId:n,userEmail:o}){let t=e.find(r=>r.email===o);if(t){let r=co({teammate:t,projectNumId:n});if(r)return r}return null},getCurrentRole(){return window.RM?.constructorRouter?.mag?.roleName??"member"},getAllProjectRoles(){let e={};try{let n=sessionStorage.getItem(fo);e=n?JSON.parse(n):{}}catch(n){console.log(n)}return e},saveProjectRole(e,n){try{let o=pe.getAllProjectRoles();o[e]=n,sessionStorage.setItem(fo,JSON.stringify(o))}catch(o){console.log(o)}},getCurrentProjectRole(e){return pe.getAllProjectRoles()[e]||"member"},getRoleForAnalytics(e){let n=pe.getCurrentRole();return e?"owner":n==="editor"?"collaborator_locked_layout":"collaborator_unlocked_layout"}}});var po=_(()=>{"use strict"});var De=_(()=>{"use strict"});var mo=_(()=>{"use strict"});var Ue,Ot=_(()=>{"use strict";Ue={COUNT_OF_ACTIONS_IN_PROJECT:"rm_count_of_actions_in_project"}});var go,yo=_(()=>{"use strict";Ot();go=(e=null)=>{if(window&&window.sessionStorage){let n=e,o=0;if(!n){let r=window.sessionStorage.getItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT);try{n=r?JSON.parse(r):null}catch{return 0}}try{for(let t in n)if(n.hasOwnProperty(t)){let r=n[t];o+=r}}catch{return o}return o}else return 0}});function R(e){if(window&&window.sessionStorage){let o=window.sessionStorage.getItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT),t=null;try{t=o?JSON.parse(o):null}catch{return}let r="action";t&&t[r]?t[r]++:(t||(t={}),t[r]=1);let s=go(t);s%100===0&&Yt.trigger("send-actions-made-data",s),window.sessionStorage.setItem(Ue.COUNT_OF_ACTIONS_IN_PROJECT,JSON.stringify(t))}}var rt=_(()=>{"use strict";po();mr();De();mo();Ot();yo()});var st,M,ho,So,Lt=_(()=>{"use strict";st=H(Ye());fe();$n();xt();io();lo();xr();dn();Ce();Re();Pr();Rt();rt();De();M=({event:e,keyCode:n,ctrlOrCmd:o=!1,shift:t=!1,alt:r=!1})=>{let s=st.KeyBindingUtil.usesMacOSHeuristics();return n===e.keyCode&&t===e.shiftKey&&r===e.altKey&&(s?o===e.metaKey:o===e.ctrlKey)},ho=e=>{let n=pe.isPermissionAllowed("TextCanChangeTypography"),o=pe.isPermissionAllowed("TextCanChangeAlign"),t=pe.isPermissionAllowed("TextCanChangeAdvancedTypography");if(M({event:e,keyCode:32,alt:!0}))return R("shortcut_alt_space"),"InsertNbsp";if(M({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0}))return R("shortcut_ctrl_alt_space"),"InsertNbsp";if(M({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0,shift:!0}))return R("shortcut_ctrl_alt_shift_space"),"InsertThinsp";if(M({event:e,keyCode:32,alt:!0,shift:!0}))return R("shortcut_alt_shift_space"),"InsertEnsp";if(M({event:e,keyCode:9}))return R(`shortcut_${e.key}`),"IncreaseIndent";if(M({event:e,keyCode:9,shift:!0}))return R(`shortcut_${e.key}_shift`),"DecreaseIndent";if(M({event:e,keyCode:65,ctrlOrCmd:!0,shift:!0}))return R("shortcut_a_ctrl_shift"),"SelectParagraph";if(M({event:e,keyCode:90,ctrlOrCmd:!0})&&R("shortcut_z_ctrl"),M({event:e,keyCode:90,ctrlOrCmd:!0,shift:!0})&&R("shortcut_z_ctrl_shift"),M({event:e,keyCode:65,ctrlOrCmd:!0})&&R("shortcut_a_ctrl"),M({event:e,keyCode:68,ctrlOrCmd:!0})&&R("shortcut_d_ctrl"),M({event:e,keyCode:68,ctrlOrCmd:!0,shift:!0})&&R("shortcut_d_ctrl_shift"),M({event:e,keyCode:84,alt:!0,ctrlOrCmd:!0}))return R("shortcut_t_ctrl_alt"),"ToggleTypographyPanel";if(M({event:e,keyCode:75,ctrlOrCmd:!0}))return R("shortcut_k_ctrl"),"ToggleLinkPanel";if(n){if(M({event:e,keyCode:38,alt:!0}))return R(`shortcut_${e.key}_alt`),"DecreaseLineHeight";if(M({event:e,keyCode:40,alt:!0}))return R(`shortcut_${e.key}_alt`),"IncreaseLineHeight";if(M({event:e,keyCode:37,alt:!0}))return R(`shortcut_${e.key}_alt`),"DecreaseLetterSpacing";if(M({event:e,keyCode:39,alt:!0}))return R(`shortcut_${e.key}_alt`),"IncreaseLetterSpacing";if(M({event:e,keyCode:190,ctrlOrCmd:!0,shift:!0}))return R("shortcut_>_ctrl_shift"),"IncreaseFontSize";if(M({event:e,keyCode:188,ctrlOrCmd:!0,shift:!0}))return R("shortcut_<_ctrl_shift"),"DecreaseFontSize"}if(o){if(M({event:e,keyCode:76,ctrlOrCmd:!0,shift:!0}))return R("shortcut_l_ctrl_shift"),"AlignLeft";if(M({event:e,keyCode:82,ctrlOrCmd:!0,shift:!0}))return R("shortcut_r_ctrl_shift"),"AlignRight";if(M({event:e,keyCode:67,ctrlOrCmd:!0,shift:!0}))return R("shortcut_c_ctrl_shift"),"AlignCenter"}if(t){if(M({event:e,keyCode:66,ctrlOrCmd:!0}))return R("shortcut_b_ctrl"),"ToggleBold";if(M({event:e,keyCode:73,ctrlOrCmd:!0}))return R("shortcut_i_ctrl"),"ToggleItalic";if(M({event:e,keyCode:85,ctrlOrCmd:!0}))return R("shortcut_u_ctrl"),"ToggleUnderline"}return(0,st.getDefaultKeyBinding)(e)},So=({action:e,editorState:n,workspace:o})=>{if(e==="InsertNbsp")return{status:"handled",editorState:ke({editorState:n,text:kn})};if(e==="InsertEnsp")return{status:"handled",editorState:ke({editorState:n,text:"\u2002"})};if(e==="InsertThinsp")return{status:"handled",editorState:ke({editorState:n,text:"\u2009"})};if(e==="IncreaseIndent"){let t=vt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="backspace"||e==="DecreaseIndent"){let t=vt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLineHeight"){let t=St({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLineHeight"){let t=St({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="IncreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=bt(n,"next");if(t)return{status:"handled",editorState:t}}else{let t=Pt({editorState:n,method:"increase"});if(t)return{status:"handled",editorState:t}}if(e==="DecreaseLetterSpacing")if(n.getSelection().isCollapsed()){let t=bt(n,"prev");if(t)return{status:"handled",editorState:t}}else{let t=Pt({editorState:n,method:"decrease"});if(t)return{status:"handled",editorState:t}}if(e==="ToggleTypographyPanel"){let t=o.controls.findControl("text_typography");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="ToggleLinkPanel"){let t=o.controls.findControl("text_link");if(t)return t.onClick.apply(t),{status:"handled",editorState:n}}if(e==="IncreaseFontSize")return{status:"handled",editorState:It({editorState:n,method:"increase"})};if(e==="DecreaseFontSize")return{status:"handled",editorState:It({editorState:n,method:"decrease"})};if(e==="AlignLeft"||e==="AlignRight"||e==="AlignCenter"){let t=e==="AlignLeft"?"align-left":e==="AlignRight"?"align-right":"align-center";return{status:"handled",editorState:un({editorState:n,align:t})}}if(e==="SelectParagraph")return{status:"handled",editorState:On(n)};if(e==="ToggleBold"){let t=K(n,"FONT_WEIGHT");return{status:"handled",editorState:ye({editorState:n,key:"FONT_WEIGHT",value:t&&t[0]==="700"?V.fontWeight:"700"})}}if(e==="ToggleItalic"){let t=K(n,"FONT_STYLE");return{status:"handled",editorState:ye({editorState:n,key:"FONT_STYLE",value:t&&t[0]==="italic"?V.fontStyle:"italic"})}}if(e==="ToggleUnderline"){let t=K(n,"DECORATION");return{status:"handled",editorState:ye({editorState:n,key:"DECORATION",value:t&&t[0]==="underline"?"none":"underline"})}}}});var xo,To=_(()=>{"use strict";Rr();Re();Ce();Gn();Ct();fe();xo=jn({htmlToEntity:(e,n,o)=>{if(e==="a")return o(Xe,"MUTABLE",zn(n))},htmlToStyle:(e,n,o)=>e==="b"?o.add(kt("FONT_WEIGHT","700")):e==="i"?o.add(kt("FONT_STYLE","italic")):o,htmlToBlock:(e,n)=>{if(e==="p"||e.match(/h\d/))return{type:"unstyled",data:Vn(n,{ignore:{lineHeight:!0,textStyles:!0}})}}})});var se,bo,Eo,_t,Co,$r,zr,Vr,ko,vo,Yr,wo,Po,Io=_(()=>{"use strict";se=H(Ye()),bo=H(hr()),Eo=H(Sr());fe();Gn();Ct();Lt();bn();rt();De();To();_t="data-draftjs-conductor-fragment",Co='[data-contents="true"] [contenteditable="false"]',$r=e=>{let{anchorNode:n,focusNode:o}=e;if(!n||!o)return!1;let t=n instanceof Element?n:n.parentElement,r=o instanceof Element?o:o.parentElement,s=t&&t.closest(Co),i=r&&r.closest(Co);return s&&i&&(s.contains(i)||i.contains(s))},zr=(e,n)=>{let{selectionState:o}=(0,Eo.default)(e,n),t=(0,bo.default)(e.getCurrentContent(),o);return t.every(s=>!!(s&&s.getText().length===0))?null:t},Vr=(e,n,o)=>{let t=(o||window).getSelection();if(!n.clipboardData||!t||!e||t.rangeCount===0||$r(t)||!e.current?._latestEditorState)return;let r=zr(e.current?._latestEditorState,e.current?.editor);if(r){n.type==="copy"?R("shortcut_c_ctrl"):n.type==="cut"&&R("shortcut_x_ctrl");let s=se.ContentState.createFromBlockArray(r.toArray()),i=JSON.stringify((0,se.convertToRaw)(s)),l=document.createElement("div");l.appendChild(t.getRangeAt(0).cloneContents()),l.setAttribute(_t,i),l.setAttribute("style","white-space: pre-wrap;"),n.clipboardData.setData("text/plain",t.toString()),n.clipboardData.setData("text/html",l.outerHTML),n.preventDefault()}},ko=(e,n)=>{let o=e.current?.editor,t=r=>{Vr(e,r,n)};return o&&o.addEventListener("copy",t),o&&o.addEventListener("cut",t),{unregister(){o&&o.removeEventListener("copy",t),o&&o.removeEventListener("cut",t)}}},vo=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=!1,s=l=>{r=M({event:l,keyCode:86,ctrlOrCmd:!0,shift:!0})},i=l=>{l.stopPropagation(),l.preventDefault(),l.cancelBubble=!0,l.returnValue=!1;let m=l.clipboardData?.getData("text/plain"),p=l.clipboardData?.getData("text/html");m&&o.props?.handlePaste&&(r?R("shortcut_v_ctrl_shift"):R("shortcut_v_ctrl"),o.props.handlePaste(m,p,o?._latestEditorState,n.forceCleanText?!0:r))};return n.forceCleanText||t.addEventListener("keydown",s,!0),t.addEventListener("paste",i,!0),{unregister(){n.forceCleanText||t.removeEventListener("keydown",s,!0),t.removeEventListener("paste",i,!0)}}},Yr=e=>{let o=new DOMParser().parseFromString(e,"text/html").querySelector(`[${_t}]`);if(o){let t=o.getAttribute(_t);try{if(t){let r=JSON.parse(t);if(r)return(0,se.convertFromRaw)(r)}}catch{return null}}return null},wo=(e="",n,o)=>{let t=n.getSelection(),r=!t.isCollapsed(),s=n.getCurrentContent(),i=_e(n),m=s.getBlockForKey(i[0]).getEntityAt(t.getStartOffset()),p="Text";return r&&!m&&Qe(e,o)&&(p="Link"),p},Po=({text:e,html:n,editorState:o,pastedWithShift:t})=>{let r=et(o),s=o.getCurrentContent(),i=_e(o),m=(()=>{let p=!t,a=i.some(d=>{let u=s.getBlockForKey(d);return!!ce({editorState:o,block:u})});if(p&&!a){let d=n?Yr(n):void 0,u=n?xo(Yn(n)):void 0;if(d||u){let E=d?.getBlockMap()||u?.getBlockMap();if(E){let C=se.Modifier.replaceWithFragment(s,r,Hn(o,Bn({originStyles:o.getCurrentInlineStyle(),blockMap:E})));return se.EditorState.push(o,C,"insert-fragment")}}}return e?ke({editorState:o,text:e}):o})();if(i.length===1){let p=s.getBlockForKey(i[0]),a=p.getEntityAt(r.getStartOffset());if(a&&s.getEntity(a)?.getType()===Xe){let d=0,u=0;p.findEntityRanges(x=>x.getEntity()===a,(x,w)=>{d=x,u=w});let E=e?.length||0,C=r.getStartOffset(),c=r.getEndOffset(),f=Math.abs(c-C),y=r.merge({anchorOffset:d,focusOffset:u+E-f});m=Un(m,y,a),m=se.EditorState.push(o,m.getCurrentContent(),"apply-entity");let S=C+E,g=r.merge({anchorOffset:S,focusOffset:S});m=Ee(m,g)}}return m}});var ue,Mt,Gr,He,Jr,Ro,it=_(()=>{"use strict";ue=H(ae()),Mt=H(Xt());qt();Gt();kr();ve();Ve();ne();Gr=O.withComponent(Te("iframe")``),He=(0,ue.createContext)({}),Jr=(0,ue.forwardRef)(({children:e,contentDidMount:n,...o},t)=>{let[r,s]=(0,ue.useState)(),[i,l]=(0,ue.useState)(null),m=()=>{if(i){let u=i.contentDocument,E=i.contentWindow;if(u&&E){let C=u.querySelector("html");s({document:u,window:E,root:C}),n&&n()}}},{body:p,head:a}=(0,ue.useMemo)(()=>r&&r.root?{body:r.root.querySelector("body"),head:r.root.querySelector("head")}:{},[r&&r.root]),d=(0,ue.useMemo)(()=>$e({key:"frame-theme",container:r?.document.head}),[r&&r.document]);return h(Gr,{ref:hn(t,l),onLoad:m,frameBorder:"0",referrerPolicy:"origin",height:"100%",width:"100%",overflow:"hidden",border:"none",display:"block",srcDoc:"<!DOCTYPE html><html><head></head><body></body></html>",...o,children:r&&r.root?z(ge,{children:[o.head&&a&&(0,Mt.createPortal)(o.head,a),p&&(0,Mt.createPortal)(h(He.Provider,{value:r,children:h(ze,{value:d,children:h(O,{width:"100%",height:"100%",children:e})})}),p)]}):null})}),Ro=Jr});function Ki({permission:e,children:n}){let o=Ne(e);return h(Oo,{disabled:!o,children:n})}function Ne(e){return pe.isPermissionAllowed(e)}var Oo,At=_(()=>{"use strict";Ve();ve();Rt();ne();Oo=Te(O)`
  &[disabled] {
    opacity: 0.4 !important;
    pointer-events: all !important;
    cursor: default !important;

    * {
      user-select: none !important;
      pointer-events: none !important;
      cursor: default !important;
    }

    input::selection {
      background: transparent !important;
    }
  }
`;Oo.displayName="PermissionContainer"});var Fo=_(()=>{"use strict";At()});var Lo,_o,qr,Xr,Zr,Mo=_(()=>{"use strict";Lo=H(Ye()),_o=(e,n)=>{let o=e.current,t=o?.editor;if(!o||!t)return;let r=()=>{let i=t;if(i){let l=new MouseEvent("mouseup",{view:n,bubbles:!0,cancelable:!0});i.dispatchEvent(l)}},s=i=>{i.stopPropagation(),i.preventDefault(),i.cancelBubble=!0,i.returnValue=!1,o._dragCount=0,o.exitCurrentMode();let l=Zr(i);if(l){if(o.props?.handleDrop){let m=o._internalDrag?"internal":"external";o.props?.handleDrop(l,{},m)}o._internalDrag=!1,r()}};return t.addEventListener("drop",s,!0),{unregister(){t.removeEventListener("drop",s,!0)}}},qr=e=>!e||!e.ownerDocument?document:e.ownerDocument,Xr=e=>{let n="data-offset-key",o=e.nodeType===Node.TEXT_NODE&&e.parentElement||e;if(!o)return null;let t=o.closest(`[${n}]`);if(!t)return null;let s=t.getAttribute(n)?.split("-");return s&&s.length?s[0]:null},Zr=e=>{let n=null,o=null,t=qr(e.currentTarget);if(typeof t.caretRangeFromPoint=="function"){let i=t.caretRangeFromPoint(e.x,e.y);n=i?.startContainer,o=i?.startOffset}else if(e.rangeParent)n=e.rangeParent,o=e.rangeOffset;else return null;let r=Xr(n);return r?new Lo.SelectionState({anchorKey:r,anchorOffset:o,focusKey:r,focusOffset:o,isBackward:!1,hasFocus:!1}):null}});function Qr(e,n,o){return e<n?n:e>o?o:e}function Ao(e,n){return n>=0&&e>=0&&e<n}function lt(e,n,o,t){return Number(Qr(e,n,o).toFixed(t))}function Ut(e,n,o){return e==="+"?n+o:n-o}function Do(e,n,o,t,r=!1){let s=[e>o,Dt(e)>t];return r&&s.push(e<n),s.every(i=>!i)}function Bt(e){return e=Number(e),Number.isFinite(e)&&!Number.isNaN(e)}function Uo(e){return e===""||e.length===1&&e[0]==="-"?!0:!!e.endsWith(".")}function Bo(e){return e.replace(",",".")}function Ho(e){let n=e.trim();function o(t,r){return t===r}for(let t=0;t<n.length;t++){let r=n[t];if(r==="."||r===","||r===""||r==="-"){let s=n[t+1];(o(r,s)||r==="-"&&t>0)&&(n=n.slice(0,t)+n.slice(t+1),t--)}}return n}function No(e){return e===""||(e=e.trim(),e[0]==="."&&(e="0"+e)),e}var Dt,Ko=_(()=>{"use strict";Dt=e=>e%1?e.toString().split(".")[1].length:0});function jo({ref:e,value:n,disabled:o=!1}){let[t,r]=(0,at.useState)("");return(0,at.useEffect)(()=>{e.current&&!o&&r(es(e.current,n))},[n,o]),[o?"":t]}var at,es,Wo=_(()=>{"use strict";at=H(ae());xn();es=(e,n)=>{if(typeof document<"u"&&e){let o=typeof n=="number"?n.toString():n,t=document.createElement("span");document.body.appendChild(t);let r=getComputedStyle(e).getPropertyValue("font-size");r&&(t.style.fontSize=r.toString()),t.style.font=Ze.fonts.main,t.style.position="absolute",t.style.left="-9999px",t.style.margin="0",t.style.width="auto",t.style.whiteSpace="pre",t.innerHTML=o;let s=Math.ceil(t.clientWidth);return s=Math.ceil(s/2)*2+2,t.remove(),s+"px"}return""}});function ts(e,n){return{...e,...n}}function $o(e,n,o){let t=n.map(r=>{let s=ts(o,r.options);return e.addEventListener(r.eventName,r.fn,s),function(){e.removeEventListener(r.eventName,r.fn,s)}});return function(){t.forEach(r=>{r()})}}var zo=_(()=>{"use strict"});var he,ns,os,ct,Vo=_(()=>{"use strict";he=H(ae()),ns=typeof window<"u"?he.useLayoutEffect:he.useEffect,os=e=>{let n=(0,he.useRef)(e);return ns(()=>{n.current=e}),(0,he.useCallback)((...o)=>{let t=n.current;return t?.(...o)},[])},ct=os});function rs(e,n){return Math.abs(n.x-e.x)>=Yo||Math.abs(n.y-e.y)>=Yo}function ss({getPhase:e,setPhase:n,getActions:o,completed:t,disableClickThreshold:r}){return[{eventName:"mousemove",fn:s=>{let{clientX:i,clientY:l}=s,m={x:i,y:l},p=e(),a=o();if(p.type==="MOVING"){s.preventDefault(),a?.move(m,s);return}let d=p.point;!r&&!rs(d,m)||(s.preventDefault(),n({type:"MOVING",point:m}),a?.start(s))}},{eventName:"mouseup",fn:s=>{let i=e(),l=o();if(i.type!=="MOVING"){t();return}s.preventDefault(),t(),l?.end(s)}}]}function Go({disabled:e=!1,onMove:n,onMoveStart:o,onMoveEnd:t,disableClickThreshold:r=!1}={}){let[s,i]=(0,j.useState)({type:"IDLE",point:{x:0,y:0}}),l=j.default.useRef(s),m=j.default.useRef(),p=(0,j.useRef)(),a=ct(n),d=ct(o),u=ct(t);(0,j.useEffect)(()=>{l.current=s},[s]);let E=(0,j.useMemo)(()=>({move:(f,y)=>{a({event:y,offset:{x:f.x-l.current.point.x,y:f.y-l.current.point.y}})},start:f=>d(f),end:f=>u(f)}),[]);(0,j.useEffect)(()=>{m.current=E},[E]);let C=(0,j.useCallback)(()=>{l.current.type!=="IDLE"&&(i({type:"IDLE",point:{x:0,y:0}}),p.current?.())},[]),c=(0,j.useCallback)(f=>{if(e){typeof p.current=="function"&&p.current();return}if(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;let y={x:f.clientX,y:f.clientY};i({type:"PENDING",point:y});let S=ss({completed:C,getPhase:()=>l.current,setPhase:i,getActions:()=>m.current,disableClickThreshold:r});p.current=$o(window,S,{capture:!0,passive:!1})},[C,e]);return(0,j.useLayoutEffect)(()=>function(){p.current?.()},[]),(0,j.useMemo)(()=>({moving:s.type==="MOVING",start:c}),[c,s])}var j,Yo,Jo=_(()=>{"use strict";j=H(ae());zo();Vo();Yo=5});function Ke(e,n){return o=>{n&&n(o),e&&e(o)}}function Zo({direction:e,labelRef:n,...o}={}){let t=Go(o);return(0,Y.useEffect)(()=>{if(!o.disabled)return n?.current&&e&&(n.current.style.setProperty("cursor",Xo[e]),n.current.style.setProperty("user-select","none"),n.current.addEventListener("mousedown",t.start)),()=>{n?.current&&(n.current.style.removeProperty("cursor"),n.current.style.removeProperty("user-select"),n.current.removeEventListener("mousedown",t.start))}},[t.start,o.disabled,e]),{...t,style:{cursor:o.disabled||!e?"initial":Xo[e]}}}var Y,qo,is,ls,Ht,Xo,Qo=_(()=>{"use strict";Y=H(ae());Ve();xn();vr();Fr();_r();Mr();Ko();Wo();Jo();ne();qo="Mixed";is=Te(eo,{excludeProps:["contextDetails"]})`
  margin: 0;
  padding: 0;
  appearance: textfield;
  border-bottom: none !important;
  font-family: ${Ze.fonts.main};

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    appearance: none;
  }
`,ls="NumericInput",Ht=(0,Y.forwardRef)((e,n)=>{let{value:o,isMixedValue:t=!1,step:r=1,shiftStep:s=10,direction:i="y",moveSpeed:l=3,autoWidth:m=!1,textStyle:p="subheading",min:a=Number.NEGATIVE_INFINITY,max:d=Number.POSITIVE_INFINITY,disableArrowInput:u=!1,text:E,disabled:C,disableScrubbing:c=!1,labelRef:f,floating:y,onChange:S,onScrubbing:g,onScrubbingStart:x,onScrubbingEnd:w,...F}=e,[k,T]=(0,Y.useState)(String(o)),[I,P]=(0,Y.useState)(!1),U=(0,Y.useRef)(0),B=(0,Y.useRef)(null),W=Sn(n,B),[X]=jo({ref:B,value:t?qo:k,disabled:!m}),{moving:oe,start:ee,style:me}=Zo({disabled:c||t||C,direction:i,labelRef:f,onMove:$,onMoveStart:A,onMoveEnd:J});(0,Y.useEffect)(()=>{T(String(o))},[o]);let re=(0,Y.useMemo)(()=>typeof y=="boolean"?y?1:0:typeof y=="number"?y:r!==void 0?Dt(r):0,[r,y]);function ie(L,D=!1){let q=Number(L),te=Ao(q,a)&&!D;return Do(q,a,d,re,D||!te)||(q=lt(q,a,d,re)),{isValid:Bt(q)&&!te,result:q}}function Z(L,D,q){let{isValid:te,result:de}=ie(L,q?.fullValidate);T(de.toString()),S&&te&&de!==o&&S({value:de,oldValue:o},D)}function xe(L){if(C)return;let D=Bo(L.target.value),q=Ho(D),te=No(q),de=Uo(q),Wt=Bt(te);!de&&Wt?Z(te,L):(de||Wt)&&T(te)}function Ie(){P(!0)}function je(L){if(P(!1),!t){let D=lt(o,a,d,re);Z(D,L,{fullValidate:!0})}}function We(L){if(L.code==="ArrowUp"||L.code==="ArrowDown"||L.code==="Enter"){L.preventDefault();let D=L.shiftKey?s*r:r;L.code==="ArrowUp"?Z(Ut("+",o,D),L,{fullValidate:!0}):L.code==="ArrowDown"&&Z(Ut("-",o,D),L,{fullValidate:!0}),L.code==="Enter"&&B.current&&B.current.blur()}}function mt(L){let D=L.target;D.selectionStart===D.selectionEnd&&D.select()}function gt(L){L.target.setSelectionRange(0,0);let D=f?.current?.contains(B.current);!t&&!D&&ee(L.nativeEvent)}function A(){x&&x(o),U.current=0}function J(){if(f&&!t){let L=lt(o,a,d,re);L!==o&&Z(L,void 0,{fullValidate:!0})}w&&w(o),U.current=0}function $({offset:L}){let D=L[i];if(i==="y"&&(D=-D),D){let q=Math.round(D/l),te=(q-U.current)*r;if(!t){let de=te+o;de!==o&&Z(de,void 0,{fullValidate:!0})}g&&te!==0&&g(te,{mixed:!!t}),U.current=q}}let le={value:k,disabled:C,height:"fit-content",color:"inherit",...F,type:"text",onChange:xe,onBlur:Ke(je,e.onBlur),onFocus:Ke(Ie,e.onFocus),onMouseUp:Ke(mt,e.onMouseUp),onMouseDown:Ke(gt,e.onMouseDown)};return u||(le.onKeyDown=Ke(We,e.onKeyDown)),E!==void 0&&!I&&(le.value=E),t||(le.style={...me,...F?.style}),t&&(le.value=qo,I&&(le.value="")),X&&(le.width=X),z(Y.Fragment,{children:[h(is,{caretColor:oe?"transparent":"auto",textStyle:p,...le,ref:W}),oe?h(no,{children:h(oo,{role:"presentation",backgroundColor:"transparent",zIndex:99999,style:me,userSelect:"none"})}):null]})});Ht.displayName=ls;Xo={x:"ew-resize",y:"ns-resize"}});var er,tr=_(()=>{"use strict";Qo();er=Ht});function us({editable:e,children:n,left:o,top:t,right:r,bottom:s,onChange:i,changedPaddings:l={}}){let{isPaddingsEnabled:m,setIsPaddingsEnabled:p}=(0,b.useContext)(dt),a=(0,b.useRef)(null).current,d=(0,b.useCallback)(x=>{a=x,p(!0)},[]),u=(0,b.useCallback)(x=>{(!a||a===x)&&p(!1)},[a]),E=(0,b.useRef)(null),{height:C}=Me(E),c=(0,b.useMemo)(()=>C<Pe,[C]),f=(0,b.useCallback)(x=>i({top:x}),[i]),y=(0,b.useCallback)(x=>i({left:x}),[i]),S=(0,b.useCallback)(x=>i({right:x}),[i]),g=(0,b.useCallback)(x=>i({bottom:x}),[i]);return z(O,{position:"relative",style:{paddingTop:t,paddingLeft:o,paddingRight:r,paddingBottom:s},children:[e&&h(ge,{children:z(O,{contentEditable:!1,display:"inline",opacity:e?1:0,visibility:e?"visible":"hidden",userSelect:"none",children:[h(ut,{isSmall:c,isChanged:l?.top,from:"top",value:t,marginLeft:o,marginRight:r,onChange:f,onStart:d,onStop:u}),h(ut,{isSmall:c,isChanged:l?.left,from:"left",value:o,marginTop:t,marginBottom:s,onChange:y,onStart:d,onStop:u}),h(ut,{isSmall:c,isChanged:l?.right,from:"right",value:r,marginTop:t,marginBottom:s,onChange:S,onStart:d,onStop:u}),h(ut,{isSmall:c,isChanged:l?.bottom,from:"bottom",value:s,marginLeft:o,marginRight:r,onChange:g,onStart:d,onStop:u})]})}),h(O,{ref:E,className:"editor-block-wrapper",userSelect:m?"none":void 0,children:n})]})}var b,nr,as,dt,Pe,Nt,cs,ut,or,Kt=_(()=>{"use strict";b=H(ae()),nr=H(Xt());qt();Gt();rr();ve();it();to();tr();ne();as=$e({key:"padding-frame-theme",container:typeof document<"u"?document.head:void 0}),dt=(0,b.createContext)({}),Pe=43,Nt=2,cs=(0,b.memo)(({isActive:e,isSmall:n,from:o,value:t,position:r,onChange:s,disabled:i})=>{let l=window.RM.constructorRouter.zoom.getZoom(),m=o==="top"||o==="bottom",p=n&&!m,a=(0,b.useRef)(null),{width:d,height:u}=Me(a),E=(0,b.useMemo)(()=>(m?d:u)*l,[m,d,u,l]),C=a&&a.current?a.current.getBoundingClientRect():{x:0,y:0},c=(0,b.useMemo)(()=>p?10:o==="top"?"22px 22px 0 0":o==="right"?"0 22px 22px 0":o==="left"?"22px 0 0 22px":"0 0 22px 22px",[p,o]),f=(0,b.useMemo)(()=>{let k=E-Pe,T=r*l-Pe/2;return Math.max(0,T<=k?T:k)},[r,E,l]),{height:y,width:S}=(0,b.useMemo)(()=>({height:p?20:Pe,width:p?38:m?Pe:47}),[p,Pe,m]),{ref:g}=(0,b.useContext)(jt),x=g&&g.current?g.current.getBoundingClientRect():{x:0,y:0},w=(0,b.useMemo)(()=>document.getElementById("paddings-input-portal"),[]),F=h(O,{display:"flex",position:"relative",justifyContent:p?"flex-start":"flex-end",flexDirection:m?"row":"column",style:{position:"absolute",...m?{left:f+x.x+C.x*l,top:x.y+C.y*l-(o==="top"?y:0)}:{top:f+x.y+C.y*l,left:x.x+C.x*l-(o==="left"?S:0)}},children:h(O,{display:"flex",backgroundColor:"blue",width:S,height:y,borderRadius:c,alignItems:"center",justifyContent:"center",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:h(er,{min:0,value:t,color:"white",fontSize:14,fontWeight:600,placeholder:"0",textAlign:"center",disabled:i,onChange:({value:k})=>s(k)})})});return h(ze,{value:as,children:z(ge,{children:[h(O,{ref:a,width:"100%",height:"100%"}),e&&w?nr.default.createPortal(F,w):null]})})}),ut=(0,b.memo)(({from:e,isChanged:n,onChange:o,value:t=0,isSmall:r,marginBottom:s=0,marginLeft:i=0,marginRight:l=0,marginTop:m=0,onStart:p,onStop:a})=>{let d=(0,b.useContext)(He),u=d&&d.window,E=(A,J)=>{let $=J;u&&u.addEventListener(A,$),window.addEventListener(A,$)},C=(A,J)=>{let $=J;u&&u.removeEventListener&&u.removeEventListener(A,$),window.removeEventListener(A,$)},c=e==="top"||e==="bottom",f=e==="bottom",[y,S]=(0,b.useState)(!1),[g,x]=(0,b.useState)(!1),[w,F]=(0,b.useState)(!1),[k,T]=(0,b.useState)(0),I=(0,b.useRef)(null),[P,U]=(0,b.useState)(0),[B,W]=(0,b.useState)(0),X=(0,b.useRef)(!1).current,oe=A=>{X=!0;let J=c?A.screenY:A.screenX,$=e==="right"?k-J:J-k;o(Math.max(0,t+$)),W(Math.max(0,(c?A.clientX:A.clientY)-P))},ee=()=>{x(!1),X&&(F(!1),a&&a(e)),X=!1};(0,b.useEffect)(()=>(g?(E("mousemove",oe),E("mouseup",ee)):(C("mousemove",oe),C("mouseup",ee)),()=>{C("mousemove",oe),C("mouseup",ee)}),[g]);let me=A=>{let J=document.getElementById("paddings-input-portal"),$=A.target;J&&!J.contains($)&&I.current&&!I.current.contains($)&&(F(!1),x(!1),ee(),a&&a(e))},re=A=>{A.key==="Escape"&&(F(!1),x(!1),ee(),a&&a(e))};(0,b.useEffect)(()=>(g||(w?(E("click",me),E("keyup",re)):(C("click",me),C("keyup",re),a&&a(e))),()=>{C("click",me),C("keyup",re)}),[g,w]);let ie=(0,b.useMemo)(()=>f?y||g?1:0:y||g?2:1,[g,y]),Z=(0,b.useMemo)(()=>c?`calc(100% - ${i+l}px)`:`${ie}px`,[ie,i,l]),xe=(0,b.useMemo)(()=>c?`${ie}px`:`calc(100% - ${s+m}px)`,[ie,s,m]),Ie=(0,b.useMemo)(()=>c?0+i:void 0,[i]),je=(0,b.useMemo)(()=>c?void 0:0+m,[m]),We=n?"tomato":"blue",mt=(0,b.useMemo)(()=>({width:c?"100%":t,height:c?t:`calc(100% - ${m+s}px)`,marginTop:c?0:m}),[c,t,m,s]),gt=(0,b.useMemo)(()=>({width:f?"100%":c?Z:`${Nt}px`,height:f||c?Nt:xe,left:f?0:Ie,top:je}),[f,c,Z,xe,Ie,je]);return z(O,{ref:I,position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",left:c?0:void 0,top:c?void 0:0,[e]:0,children:[h(O,{backgroundColor:"rgba(28, 222, 180, 0.18)",style:mt}),z(O,{position:"absolute",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onMouseDown:A=>{let J=document.getElementById("paddings-input-portal");if(!(J&&J.contains(A.target))){if(!w){let $=A.target.getBoundingClientRect(),le=c?$.x:$.y;U(le),W(Math.max(0,(c?A.clientX:A.clientY)-le)),F(!0)}T(c?A.screenY:A.screenX),x(!0),p&&p(e)}},[e]:f?0:"100%",cursor:c?"row-resize":"col-resize",style:gt,children:[h(O,{position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",bottom:e==="top"?"100%":void 0,top:e==="bottom"?"100%":void 0,left:e==="right"?"100%":void 0,right:e==="left"?"100%":void 0,children:h(cs,{isSmall:r,position:B,isActive:w,onChange:o,value:t,from:e,disabled:g})}),h(O,{display:"flex",width:"100%",height:"100%",alignItems:e==="top"?"flex-start":"flex-end",justifyContent:e==="right"?"flex-end":void 0,children:h(O,{style:{width:c?"100%":`${ie}px`,height:c?`${ie}px`:"100%",backgroundColor:y||g||f||t&&t>0?We:"transparent"}})})]}),f&&h(O,{position:"absolute",backgroundColor:t&&t>1?We:"transparent",top:0,height:"1px",style:{left:Ie,width:Z}})]})});or=us});function ds({children:e,...n}){let{model:{isEditMode:o,useTextWidgetStore:t}}=(0,Q.useContext)(Fe),{model:r}=(0,Q.useContext)(Le),s=r.flags?.calculatedLineHeight,i=Ne("TextCanChangePaddings"),[l,m]=t({partial:!1}),[p]=Ge(),{blockKey:a,block:d}=(0,Q.useMemo)(()=>{if(!n["data-offset-key"])return{};let T=n["data-offset-key"].split("-")[0],I=l.getCurrentContent().getBlockForKey(T);return{blockKey:T,block:I}},[n,l]),u=(0,Q.useMemo)(()=>ce({block:d}),[d]),E=(0,Q.useMemo)(()=>!!(a&&In(l,a)),[l,a]),C=E?"var(--editor-border-color)":"transparent",c=(0,Q.useMemo)(()=>[...p.global,...p.project].find(T=>T.name===u),[u,p,l]),{paddings:f,changedPaddings:y}=(0,Q.useMemo)(()=>{let T=Tt({block:d}),I=c?Nn(c):{};return{paddings:{left:0,right:0,top:0,bottom:0,...I,...T},changedPaddings:pn({blockPaddings:T,stylePaddings:I})}},[l,d,c,p]),S=T=>{let I=_e(l),P=l.getCurrentContent(),U=I.reduce((B,W)=>{let X=P.getBlockForKey(W);if(X){let oe=Tt({block:X});return fn({editorState:B,block:X,paddings:{...oe,...T}})}return B},l);m(U)},g=(0,Q.useMemo)(()=>qe({block:d}),[l,d,p]),x=(0,Q.useMemo)(()=>Wn({block:d}),[l,d]),w=(0,Q.useMemo)(()=>s?Mn({block:d,width:r.w}):{},[l,d,p]),F=(0,Q.useMemo)(()=>{if(d&&!we({block:d})){let{r:I,g:P,b:U,a:B}=Qt(An(d));return`rgba(${I}, ${P}, ${U}, ${B})`}},[l,d]),k=i===!1?i:o&&E;return h(O,{...n,position:"relative",style:{lineHeight:typeof g=="number"?`${g}px`:void 0,textIndent:typeof x=="number"?`${x}px`:void 0,...w},css:Jt`
        // Заглушаем паддинги текстового стиля, чтобы отдать управление ими в TextPaddings
        padding: 0 !important;

        // Хак рамки, чтобы у нескольких элементов подряд не вышло 2px рамки
        &:after {
          content: '';
          pointer-events: none;
          box-shadow: 1px 0 0 0 ${C}, 0 1px 0 0 ${C}, 1px 1px 0 0 ${C},
            1px 0 0 0 ${C} inset, 0 1px 0 0 ${C} inset;
          position: absolute;
          top: 0;
          left: -1px;
          width: calc(100% + 1px);
          height: calc(100% - 1px);
        }

        // Дефолтный цвет для списков
        .editor-block-wrapper:before,
        div[data-offset-key]:before,
        & > li:before {
          ${F?`color: ${F};`:""}
        }
      `,children:h(or,{editable:k,top:f.top,left:f.left,bottom:f.bottom,right:f.right,changedPaddings:y,onChange:S,children:e},a)})}var Q,sr,ir=_(()=>{"use strict";Q=H(ae());Je();fe();ve();Kt();yn();Cr();xt();$n();Tn();Tr();nt();At();Ve();ne();sr=ds});var G,ft,lr,fs,ps,ar,cr=_(()=>{"use strict";G=H(ae()),ft=H(Ye());ve();lr=H(yr());Ce();Xn();fe();Io();gr();it();Fo();Mo();bn();wr();Ct();Je();rt();De();ht();ir();Re();nt();an();ne();fs=()=>{let e=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,n={...rn(),...Zt,...ln};return lr.default.Map(Object.keys(n).reduce((o,t)=>{let r=n[t].element,s=e?sr:r,i=tt(t)?h(Zn,{type:t}):void 0;return Object.assign(o,{[t]:{...n[t],element:s,wrapper:i}}),o},{}))},ps=(0,G.forwardRef)(({isEditMode:e,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,disableSelectionHighlight:p,...a},d)=>{let u=(0,G.useRef)(null),E=(0,G.useContext)(He),C=Ne("TextCanChangeTypography");(0,G.useEffect)(()=>{if(u&&u.current!==null){let g=E&&E.window||window,x=u,w=ko(x,g),F=_o(x,g),k=vo(x,{forceCleanText:!C});return()=>{w.unregister(),F?.unregister(),k?.unregister()}}},[u]),(0,G.useEffect)(()=>{let g=d;g!==null&&g.current&&u.current&&!g.current.focusEditor&&(g.current.focusEditor=u.current.focus)},[u,d]);let c=(0,G.useCallback)((g,x,w,F)=>{let{mag:k,workspace:T}=window.RM.constructorRouter,I=wo(g,w,k),P;switch(I){case"Link":{let U=Qe(g,k);if(U){let B=nn(),W=Cn(k,B.project,B.global)||mn.name;P=En({editorState:w,url:g,type:U,linkStyle:W}),T.controls?.select(T.controls?.findControl("text_link"))}break}case"Text":{P=Po({text:g,html:x,editorState:w,pastedWithShift:F});break}}return P?(F||window.RM.constructorRouter.trigger("notice:triggerEduTip","textWidgetPasteWithoutFormatting",{showOnce:!0}),a.onChange(P),"handled"):"not-handled"},[a.onChange]),f=(0,G.useCallback)((g,x)=>{if(g.shiftKey){R("shortcut_shift_enter");let F=Ln(x);return a.onChange(F),"handled"}let w=Fn(x);if(w){let{status:F,editorState:k}=w;return a.onChange(k),F}return"not-handled"},[a.onChange]),y=(0,G.useCallback)(g=>g?(a.onChange(_n({editorState:a.editorState,dropSelection:g})),"handled"):"not-handled",[a.onChange,a.editorState]),S=(0,G.useMemo)(()=>ft.DefaultDraftBlockRenderMap.merge(fs()),[]);return h(qn,{ref:d,textDirection:n,autosize:o,columns:t,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,isEditMode:e,disableSelectionHighlight:p,children:h(O,{children:h(ft.Editor,{ref:u,spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",stripPastedStyles:!1,blockRenderMap:S,customStyleFn:en,handlePaste:c,handleReturn:f,handleDrop:y,...a})})})}),ar=ps});var N,ur,ka,dr=_(()=>{"use strict";N=H(ae());Ce();Je();fe();Re();nt();ht();xt();Er();Vt();ur=(e,n={})=>{let[o,t]=yt(),[r]=Ge(),s=Array.isArray(e)?e:[e],i=(0,N.useMemo)(()=>s.map(c=>vn(c)),[s]),l=(0,N.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),m=(0,N.useMemo)(()=>s.map(c=>ce({editorState:c})),[s]),p=(0,N.useMemo)(()=>m.map(c=>l.find(f=>f.name===c)).filter(Boolean),[m,l]),a=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_FAMILY"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontFamily||"":V.fontFamily}),[p,s]),d=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_STYLE"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontStyle||"":V.fontStyle}),[p,s]),u=(0,N.useMemo)(()=>s.map((c,f)=>{let y=K(c,"FONT_WEIGHT"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontWeight||"":V.fontWeight}),[p,s]);(0,N.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&a.length&&u.length&&d.length){let c=s.map((f,y)=>{let S=$t(a)[y],g=u[y],x=d[y];if(S){let w=Oe({fontFamily:S,fontWeight:g,fontStyle:x});if(!o[w])return Et({fontFamily:S,fontWeight:g,fontStyle:x}).then(k=>({res:k,key:w}))}});Promise.all(c).then(f=>{let y={};f.forEach(S=>{S?.res&&(y[S.key]=S.res)}),Object.keys(y).length!==0&&t({...o,...y})})}},[s]);let E=(0,N.useMemo)(()=>s.map((c,f)=>{let y=a[f],S=u[f],g=d[f];if(y&&S&&g){let x=Oe({fontFamily:y,fontWeight:S,fontStyle:g});return o[x]}}),[s,o]);return(0,N.useMemo)(()=>{let c={textStyle:[],textStyleName:[],fontFamily:[],fontStyle:[],fontWeight:[],fontInfo:[],fontSize:[],lineHeight:[],ratio:[],letterSpacing:[],fontSizeLinkStatus:[],letterSpacingLinkStatus:[]};for(let f=0;f<s.length;f++){let y=s[f],S=p[f],g=i[f],x=E[f],w=m[f],F=a[f],k=d[f],T=u[f],I=S&&S.name!=="unstyled",P=I&&be(S?.cssProperties.fontSize),U=I&&be(S?.cssProperties.lineHeight),B=I&&be(S?.cssProperties.letterSpacing,!0),W=K(y,"FONT_SIZE"),X=K(y,"LETTER_SPACING"),oe=qe({block:g}),ee=K(y,"IS_LINKED_LETTER_SPACING"),me=gn({block:g}),re=W?.length?parseInt(W[0]):P||V.fontSize,ie=X?.length?parseFloat(X[0]):B||0,Z=typeof oe=="number"?oe:U||V.lineHeight,xe=ee&&ee[0]&&typeof ee[0]<"u"?ee[0]==="true":!1;c.textStyle.push(S),c.textStyleName.push(w),c.fontFamily.push(F),c.fontStyle.push(k),c.fontWeight.push(T),c.fontInfo.push(x),c.fontSize.push(re),c.lineHeight.push(Z),c.ratio.push(re/Z),c.letterSpacing.push(ie),c.fontSizeLinkStatus.push(me),c.letterSpacingLinkStatus.push(xe)}return c},[s,i,p,a,E,d,u,m])},ka=(e,n={})=>{let[o,t]=yt(),[r]=on(),s=(0,N.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),i=(0,N.useMemo)(()=>we({editorState:e}),[e]),l=(0,N.useMemo)(()=>s.find(u=>u.name===i),[s,i]),m=(0,N.useMemo)(()=>{let u=K(e,"FONT_FAMILY");return l?l.cssProperties.fontFamily||"":u.length?u[0]:V.fontFamily},[l,e,i]),p=(0,N.useMemo)(()=>{let u=K(e,"FONT_STYLE");return l?l.cssProperties.fontStyle||V.fontStyle:u.length?u[0]:V.fontStyle},[l,e,i]),a=(0,N.useMemo)(()=>{let u=K(e,"FONT_WEIGHT");return l?l.cssProperties.fontWeight||"":u.length?u[0]:V.fontWeight},[l,e,i]);(0,N.useEffect)(()=>{if(n.listenFontFeaturesUpdates&&m&&a&&p){let u=Oe({fontFamily:m,fontWeight:a,fontStyle:p});o[u]||Et({fontFamily:m,fontWeight:a,fontStyle:p}).then(C=>{if(C){let{features:c,variations:f,characters:y}=C;t({...o,[u]:{features:c,variations:f,characters:y}})}})}},[e,n.listenFontFeaturesUpdates]);let d=(0,N.useMemo)(()=>{if(m&&a&&p){let u=Oe({fontFamily:m,fontWeight:a,fontStyle:p});return o[u]}},[e,o]);return{listStyle:l,listStyleName:i,fontFamily:m,fontStyle:p,fontWeight:a,fontInfo:d}}});function ms({readOnly:e}){let{model:n,modelSet:o,modelSave:t}=(0,v.useContext)(Le),{model:{useTextWidgetStore:r,isEditMode:s,workspace:i,selected:l,isJustCreated:m,disableSelectionHighlight:p,isResizing:a}}=(0,v.useContext)(Fe),[d,u]=r({partial:!1});ur(d,{listenFontFeaturesUpdates:!0});let{isPaddingsEnabled:E}=(0,v.useContext)(dt),{callback:C}=wt(t,400),{callback:c}=wt(T=>{if(s&&T.getLastChangeType()){let P=wn(T.getCurrentContent()),U=Object.keys(P),B=(0,pt.pick)(n,...U),W=(0,pt.isEqual)(P,B);o(P),W||C()}},20);(0,v.useEffect)(()=>{s&&m&&setTimeout(()=>{S.current?.focusEditor()},0)},[]),(0,v.useEffect)(()=>{c(d)},[d]);let f=(0,v.useMemo)(()=>d.getSelection().getHasFocus(),[d]),y=(0,v.useMemo)(()=>s,[s,f]),S=(0,v.useRef)(null),{height:g}=Me(S),x=(0,v.useMemo)(()=>n.columns&&n.columns.count>1,[n.columns]);(0,v.useEffect)(()=>{!a&&g>0&&g!==n.h&&s&&!x&&n.autosize&&(o({h:g}),C())},[g,n.autosize,n.h,x,a]),(0,v.useEffect)(()=>{!Modernizr.firefox&&!s&&!d.getSelection().isCollapsed()&&u(Pn(d))},[s]);let w=(0,v.useCallback)(T=>{let I=T.getType(),P=ce({block:T}),U=cn({block:T}),B=tt(I)?we({block:T})||(n.flags?.newListPosition?sn:void 0):void 0;return["edit-mode",I,P,U,B].filter(W=>W).join(" ")},[]),F=(0,v.useCallback)(T=>{let I=T.getSelection(),P=T;P=Dn(P,d),P=Ee(P,Rn(I)),P=P.getSelection().isCollapsed()?P:Ee(P,et(P)),Modernizr.safari&&!I.isCollapsed()&&(P=Ee(P,P.getSelection(),!1)),u(P)},[d]),k=(0,v.useCallback)(T=>{let I=So({action:T,editorState:d,workspace:i});if(I){let{editorState:P,status:U}=I;return u(P),U}else return"not-handled"},[d,i]);return h(ar,{ref:S,isEditMode:s,bgColor:n.bgColor,selectionColor:n.selectionColor,textDirection:n.textDirection||"LTR",autosize:n.autosize,columns:n.columns,verticalAlign:n.verticalAlign,useBaseline:n.flags?.baseline,shouldShowSelectionBorder:y,editorState:d,disableSelectionHighlight:p,blockStyleFn:w,onChange:F,readOnly:!s||!l||e||E,keyBindingFn:ho,handleKeyCommand:k})}function gs({size:e,height:n,width:o,onClick:t}){return z(ge,{children:[h(O,{position:"absolute",top:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(O,{position:"absolute",bottom:0,left:0,onClick:t,userSelect:"none",style:{width:o+e*2,height:e}}),h(O,{position:"absolute",top:0,left:0,width:e,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}}),h(O,{position:"absolute",top:0,right:0,onClick:t,userSelect:"none",style:{width:e,height:n+e*2}})]})}function hs(){let{model:{useTextWidgetStore:e,fontStyles:n,isResizing:o,leaveEditMode:t,isEditMode:r,canControlsBeClosed:s,onIframeLoaded:i}}=(0,v.useContext)(Fe),[l]=e({partial:!1}),{model:{w:m,h:p}}=(0,v.useContext)(Le),[a,d]=(0,v.useState)(!1);(0,v.useEffect)(()=>{a&&Kn()},[a,o]);let u=(0,v.useRef)(null),E=(0,v.useMemo)(()=>{let k={position:"absolute",top:Se*-1,left:Se*-1,width:`calc(100% + ${Se*2}px)`,height:`calc(100% + ${Se*2}px)`,fontFamily:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif",lineHeight:1};return{display:r?void 0:"none",pointerEvents:!r||a||o?"none":void 0,userSelect:"none",...k}},[Se,r,a,o]),C=(0,v.useCallback)(()=>{s()&&t()},[s,t]),[c,f]=(0,v.useState)(!1),[y,S]=(0,v.useState)(!1);(0,v.useEffect)(()=>{r&&!c&&f(!0)},[r]);let[g,x]=(0,v.useState)(!1),w=(0,v.useRef)(null),F=()=>{let k=u.current?.contentDocument?.hasFocus()||!1;if(k){let T=u.current?.contentDocument?.getSelection();T&&T.anchorNode&&T.focusNode&&(w.current={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset})}x(k)};return(0,v.useEffect)(()=>(u.current?.contentDocument?.addEventListener("selectionchange",F),()=>{u.current?.contentDocument?.removeEventListener("selectionchange",F)}),[u.current?.contentDocument]),(0,v.useEffect)(()=>{if(Modernizr.safari){let k=l.getSelection(),T=k.getHasFocus();if(!g&&T&&!k.isCollapsed()){let I=u.current?.contentWindow?.getSelection();I&&w.current&&I.setBaseAndExtent(w.current.anchorNode,w.current.anchorOffset,w.current.focusNode,w.current.focusOffset)}}},[l,g]),h(jt.Provider,{value:{ref:u},children:h(dt.Provider,{value:{isPaddingsEnabled:a,setIsPaddingsEnabled:d},children:z(O,{position:"relative",width:"calc(var(--workspace-inverse-zoom) * 100%)",height:"calc(var(--workspace-inverse-zoom) * 100%)",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:[c&&z(Ro,{ref:u,style:E,head:z(ge,{children:[h("style",{children:`
                      body {
                        margin: 0;
                        height: 100vh;
                        width: 100vw;
                        overflow: hidden;
                        box-sizing: border-box;
                        padding: ${Se}px ${Se-Jn}px;
                      }

                      ol, ul {
                        padding: 0;
                        margin: 0;
                      }
                  `}),n.map((k,T)=>{if(k.tag==="style")return h("style",{children:`${k.style}`},T);if(k.tag==="link")return h("link",{rel:"stylesheet",type:k.type,href:k.href},T)})]}),contentDidMount:()=>{i(),S(!0)},children:[h(ro,{mode:"constructor"}),r&&h(ys,{size:Se,height:p,width:m,onClick:C}),h(ms,{})]}),r&&y?null:h(O,{height:"100%",width:"100%",position:"absolute",top:0,left:0,pointerEvents:"none",userSelect:"none",children:h(Qn,{editorState:l,isConstructorPreview:!0})})]})})})}var v,pt,fr,jt,ys,Se,Xa,rr=_(()=>{v=H(ae()),pt=H(pr());Dr();Tn();fr=H(Lr());cr();fe();br();dn();Kt();yn();Lt();Ar();nt();an();Or();ve();it();Xn();dr();to();Ir();ne();jt=(0,v.createContext)({});ys=(0,v.memo)(gs,fr.default),Se=500;Xa=hs});export{Ae as a,ao as b,Rs as c,Br as d,Os as e,Hr as f,Fs as g,Ls as h,_s as i,Ms as j,co as k,As as l,uo as m,pe as n,Rt as o,xo as p,To as q,po as r,De as s,Ue as t,Ot as u,R as v,rt as w,Oo as x,Ki as y,Ne as z,Fo as A,jo as B,Wo as C,ct as D,Vo as E,Go as F,Jo as G,er as H,tr as I,ur as J,ka as K,dr as L,jt as M,Se as N,Xa as O,rr as P};
