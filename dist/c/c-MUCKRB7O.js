import{a as K,b as De,f as ee,h as Oe,i as te,j as oe,k as Ve}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-4JJEYKCD.js";import{a as re,b as Te}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-J5DKF6EV.js";import{a as Q,b as He}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-2QRN3A7F.js";import{a as ie,b as We,c as ae,d as Ae}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-VUJ4FLYQ.js";import{a as _e}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-HO55OAEP.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-T6TN5YO4.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-W5OZJVNV.js";import{a as J,g as ze}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-PTOZSKV6.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-WEREZOGV.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-A23WIZTM.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-CXA7FWYL.js";import{a as s,d as Z}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-3GOT4LKE.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-BFEJMD7T.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-6P4KCQ22.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-SHJ7QGQT.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-FFSQZJFP.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-C3SKTX2K.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-Z4COXDDT.js";import{r as k,v as A}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-6KVCTNLD.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-O4L6L2GG.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-VMLLFM4X.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-BDTBHKNZ.js";import{c as q}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-LA3FLWVR.js";import{C as i,D as R,E as p}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-U6WQ4G6W.js";import{a as Me}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-7ZY2VSVL.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-VPHMCDHS.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-5JZ2YWXB.js";import{b as W,c as Ee}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-DQFZXCVV.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-H3ZPPNIG.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-S4OSB3PN.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-KI5HOILD.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-IJGABWID.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-CD44EXNS.js";import"https://st-p.rmcdn.net/a09f30ec/dist/c/c-SLUQJE2K.js";import{a as L,d as Ue}from"https://st-p.rmcdn.net/a09f30ec/dist/c/c-4X7D5KOI.js";var Ze,je,ne,se=L(()=>{"use strict";A();Z();p();Ze=e=>i("svg",{width:64,height:64,viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:i("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 4C0 1.79086 1.79086 0 4 0C6.20914 0 8 1.79086 8 4V60C8 62.2091 6.20914 64 4 64C1.79086 64 0 62.2091 0 60V4ZM56 28C56 25.7909 57.7909 24 60 24C62.2091 24 64 25.7909 64 28V36C64 38.2091 62.2091 40 60 40C57.7909 40 56 38.2091 56 36V28ZM46 18C43.7909 18 42 19.7909 42 22V42C42 44.2091 43.7909 46 46 46C48.2091 46 50 44.2091 50 42V22C50 19.7909 48.2091 18 46 18ZM28 16C28 13.7909 29.7909 12 32 12C34.2091 12 36 13.7909 36 16V48C36 50.2091 34.2091 52 32 52C29.7909 52 28 50.2091 28 48V16ZM18 6C15.7909 6 14 7.79086 14 10V54C14 56.2091 15.7909 58 18 58C20.2091 58 22 56.2091 22 54V10C22 7.79086 20.2091 6 18 6Z",fill:"#B8B8B8"})}),je=s.withComponent(k(Ze)`
      display: block;
    `),ne=je});var Xe,$e,le,de=L(()=>{"use strict";A();Z();p();Xe=e=>R("svg",{width:8,height:8,viewBox:"0 0 8 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[i("circle",{cx:6,cy:6,r:2,fill:"#282828"}),i("circle",{cx:2,cy:2,r:2,fill:"#282828"}),i("circle",{cx:2,cy:6,r:2,fill:"white"}),i("circle",{cx:6,cy:2,r:2,fill:"white"})]}),$e=s.withComponent(k(Xe)`
      display: block;
    `),le=$e});function qe(e){let{model:{_id:m,w:n,h:u,basePath:l,numberOfImages:h,scrollSpeed:U=1,imageWidth:b=0,imageHeight:y=0,fixed_position:E,scrollStartPoint:M="bottom",playbackType:z,startPointOffset:C,scrollDelay:v,is_full_width:I,is_full_height:D,useEasing:B=!1,fileExtension:ue,pausable:fe,byStepSpeed:ge,byStepLoop:pe,byStepSpringLoop:he,firstFrameLambdaUrl:S,webp:be},modelSave:Se}=(0,o.useContext)(J),{model:{currentScrollOffset:H,hoverPercent:O,mouseIn:w,pageScale:V=1,viewport:we,canDirectLinkBeUsed:xe,pageContentTop:ye=0,magContainerHeight:Ce=0,widgetBoxTop:ve=0,isStarted:X=!1},model:$}=(0,o.useContext)(re),[{isUploading:x,files:N,url:P},f]=e.useSharedState?e.useSharedState():Ye,_=e.mode==="viewer",[Ie,Be]=(0,o.useState)(!1),[G,Pe]=(0,o.useState)(!1),Y=(0,o.useRef)(null),c=(0,o.useRef)(null),Fe=c.current,T=(0,o.useRef)(null),g=T.current,Le=(r,t)=>{if(I||D)return{w:n,h:u};let d=r<=480?r:Math.round(r*480/r),F=t*d/r;return{w:d,h:F}},ke=(0,o.useMemo)(()=>{if(S){let r=new URL(S);return r.searchParams.append("w","40"),r.toString()}},[S]);(0,o.useEffect)(()=>{l&&h&&(c.current=new ie(l,_?h:1,ue,!!be,()=>{Pe(!0),e.onAllImagesLoaded&&e.onAllImagesLoaded()}),c.current.preloadFirstImage(),T.current=new ae(Y.current,c.current,z==="mousemove"?1:0),T.current.drawImageByIndex(0).then(()=>{e.onFirstFrameLoaded&&e.onFirstFrameLoaded()}))},[l]);let[a,Re]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(!a)return;let r=(t,d)=>t===W.widget.defaults.w&&d===W.widget.defaults.h;Se({basePath:a.basePath,imageWidth:a.imageWidth,imageHeight:a.imageHeight,numberOfImages:a.numberOfImages,fileExtension:a.fileExtension,totalSize:a.totalSize,jpeg:a.jpeg,webp:a.webp,firstFrameLambdaUrl:a.firstFrameLambdaUrl,...r(n,u)?Le(a.imageWidth||n,a.imageHeight||n):{}})},[a]),(0,o.useEffect)(()=>{let r=async()=>{try{let t;if(P&&P.length)t=await ee(P,m);else{let{errorMsg:d,validated:F}=te(N);if(d||!F){f({isUploading:!1,uploadError:d}),setTimeout(()=>alert(d),0);return}t=await oe(F,m)}t&&t.basePath&&t.imageHeight&&t.imageWidth&&t.numberOfImages&&t.totalSize&&!$.isDestroyed&&!Ie?(Re({basePath:t.basePath,imageWidth:t.imageWidth,imageHeight:t.imageHeight,numberOfImages:t.numberOfImages,totalSize:t.totalSize,fileExtension:t.fileExtension,firstFrameLambdaUrl:t.firstFrameLambdaUrl,jpeg:t.jpeg,webp:t.webp}),f({isUploading:!1})):f({isUploading:!1,uploadError:"Error uploading video"})}catch{f({isUploading:!1,uploadError:"Error uploading video"})}};x&&(P||N)&&!$.isDestroyed&&r()},[x]),(0,o.useEffect)(()=>{!_||!c.current||(X?c.current.startLoad():c.current.stopLoad())},[X]),(0,o.useEffect)(()=>{if(!Fe)return;let r;if(!_)g?.drawImageByIndex(0);else if(typeof H<"u")r=Ge({currentScrollOffset:H,pageContentTop:ye,pageScale:V,magContainerHeight:Ce,widgetBoxTop:ve,scrollStartPoint:M,startPointOffset:C,scrollSpeed:U,scrollDelay:v,isFixed:!!E}),g?.drawImageByIndex(r,B);else if(typeof O<"u")g?.drawImageByTimelinePercent(O,B);else if(typeof w<"u")w&&g?.startDrawingByStep(h,{speed:ge,loop:pe,spring:he}),!w&&fe?g?.pauseDrawingByStep():w||g?.stopDrawingByStep();else return},[H,we,n,u,O,w]),(0,o.useEffect)(()=>(f({canDirectLinkBeUsed:xe}),e.onFirstRender&&e.onFirstRender(),()=>{Be(!0)}),[]),R(s,{display:"flex",alignItems:"center",justifyContent:"center",backgroundRepeat:"no-repeat",css:q`
        label {
          position: absolute;
          cursor: default;
          z-index: 1001;
          width: 100%;
          height: 100%;
        }
      `,backgroundColor:e.mode!=="constructor"||l?"transparent":"lightGray",width:"100%",height:"100%",backgroundPosition:"center",className:"shots-cover",children:[!l&&e.mode==="constructor"&&!x&&i(s,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",children:i(ne,{})}),e.mode==="constructor"&&l&&i(s,{display:"flex",position:"absolute",zIndex:1e3,backgroundImage:`url(${le})`,backgroundRepeat:"repeat",width:"100%",height:"100%",opacity:.4}),e.mode==="constructor"&&i(K,{id:`rm-shots-widget-file-upload-${m}`,onClick:r=>{r.preventDefault()},readFileData:!1,onChangeMultiple:r=>{f({files:r,isUploading:!0})},position:"absolute",zIndex:1001,dropFile:!x,accept:"image/png, image/jpeg, video/*, .mkv",multiple:!0}),x&&i(s,{display:"flex",position:"absolute",top:"50%",left:"50%",cursor:"default",transform:"translate(-50%, -50%)",children:i(Q,{bgColor:"gray",size:"big"})}),i("canvas",{id:m,width:e.mode==="constructor"||V>1?b:Math.min(b,Math.floor(n*ce)),height:e.mode==="constructor"||V>1?y:Math.min(y,Math.floor(u*ce)),ref:Y,style:{objectFit:"cover",userSelect:"none",width:"100%",height:"100%",zIndex:1e3,...G||!S?{opacity:1,visibility:e.mode==="constructor"?"inherit":"visible"}:{opacity:0,visibility:e.mode==="constructor"?"inherit":"hidden"}},children:"Your browser does not support Canvas element"})," ",S&&!G&&i(s,{position:"absolute",left:"0",right:"0",bottom:"0",top:"0",zIndex:1001,backgroundImage:`url(${ke})`,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",filter:"blur(5px)"})]})}var o,ce,Ne,me,Ge,Ye,Je,j=L(()=>{"use strict";o=Ue(Me());Z();He();De();se();ze();We();_e();Oe();Ee();Ae();Te();Ve();de();A();p();ce=window.devicePixelRatio||1,Ne={top:1,center:.5,bottom:0},me=10,Ge=({currentScrollOffset:e,pageContentTop:m,pageScale:n,magContainerHeight:u,widgetBoxTop:l,scrollStartPoint:h,startPointOffset:U,scrollSpeed:b,scrollDelay:y,isFixed:E})=>{let M=m/n,z=u/n,C=e/n;if(E)return Math.round((C-y)*b/me);let v=l+M,I=v-z,D=Ne[h],B=D*(v-I)+I+U;return Math.round((C-B)*b/me)},Ye=[{},()=>{}];Je=qe});var Ke=L(()=>{j();j()});Ke();export{Je as Shots};
